<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Mutations · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Mutations · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/relay/index.html"/><meta property="og:description" content="Relay exposes the following APIs to perform mutations."/><link rel="shortcut icon" href="/relay/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/relay/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/relay/"><img class="logo" src="/relay/img/relay-white.svg"/><h2 class="headerTitle">Relay</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/relay/docs/en/getting-started.html" target="_self">Docs</a></li><li><a href="/relay/en/help.html" target="_self">Support</a></li><li><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Relay Modern</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Quick Start</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/tutorial.html">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/thinking-in-graphql.html">Thinking in GraphQL</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/thinking-in-relay.html">Thinking In Relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/videos.html">Videos</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Modern</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-modern.html">Introduction to Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/new-in-relay-modern.html">New in Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-environment.html">The Relay &quot;Environment&quot;</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/network-layer.html">The Relay Network Layer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/query-renderer.html">QueryRenderer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/fragment-container.html">FragmentContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/refetch-container.html">RefetchContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/pagination-container.html">PaginationContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/routing.html">Routing</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/relay/docs/en/mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/subscriptions.html">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-directives.html">Directives</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/babel-plugin-relay.html">babel-plugin-relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-compiler.html">Relay Compiler</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-debugging.html">Debugging</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Compat</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-compat.html">Compatibility Mode</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/conversion-playbook.html">Conversion Playbook</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/conversion-scripts.html">Conversion Scripts</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/upgrading-setvariables.html">Upgrading setVariables</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/compatibility-cheatsheet.html">Compatibility Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-cheatsheet.html">API Cheatsheet</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic Guides</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-containers.html">Containers</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-routes.html">Routes</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-root-container.html">Root Container</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-ready-state.html">Ready State</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-network-layer.html">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-babel-plugin.html">Babel Relay Plugin</a></li></ul></div><div class="navGroup navGroupActive"><h3>GraphQL</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-relay-specification.html">GraphQL Relay Specification</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-object-identification.html">Object Identification</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-connections.html">Connection</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-further-reading.html">Further Reading</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic API</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay.html">Relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-container.html">RelayContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-route.html">Relay.Route</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-renderer.html">Relay.Renderer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-root-container.html">Relay.RootContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-ql.html">Relay.QL</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-mutation.html">Relay.Mutation</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-graphql-mutation.html">Relay.GraphQLMutation</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-proptypes.html">Relay.PropTypes</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-store.html">Relay.Store</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic Interfaces</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-mutation-request.html">RelayMutationRequest</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-network-layer.html">RelayNetworkLayer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-query-request.html">RelayQueryRequest</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/relay/edit/master/docs/Modern-Mutations.md" target="_blank">Edit</a><h1>Mutations</h1></header><article><div><span><p>Relay exposes the following APIs to perform mutations.</p>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> {commitMutation} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-relay'</span>);

type Variables = {[name: string]: any};

commitMutation(
  environment: Environment,
  <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">mutation</span>: GraphQLTaggedNode,
    <span class="hljs-attr">variables</span>: Variables,
    onCompleted?: ?<span class="hljs-function">(<span class="hljs-params">response: ?<span class="hljs-built_in">Object</span>, errors: ?[<span class="hljs-built_in">Error</span>]</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
    onError?: ?<span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span></span>) =&gt;</span> <span class="hljs-keyword">void</span>,
    optimisticResponse?: <span class="hljs-built_in">Object</span>,
    optimisticUpdater?: ?<span class="hljs-function">(<span class="hljs-params">store: RecordSourceSelectorProxy</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
    updater?: ?<span class="hljs-function">(<span class="hljs-params">store: RecordSourceSelectorProxy, data: SelectorData</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
    configs?: <span class="hljs-built_in">Array</span>&lt;RelayMutationConfig&gt;,
  },
);
</code></pre>
<p>First, let's take a look at the <code>environment</code> input. To perform the mutation on the correct <code>environment</code> with the relevant data, it's a good idea to use the <code>environment</code> used to render the components. It's accessible at <code>this.props.relay.environment</code> from the component.</p>
<p>Now let's take a closer look at the <code>config</code>:</p>
<ul>
<li><code>mutation</code>: the <code>graphql</code> tagged mutation query.</li>
<li><code>variables</code>: an object that contains the variables needed for the mutation.</li>
<li><code>onCompleted</code>: a callback function executed with the 'raw' response and errors from the server after the in-memory Relay store is updated with the <code>updater</code>.</li>
<li><code>onError</code>: a callback function executed when Relay encounters an error.</li>
<li><code>optimisticResponse</code>: an object conforming to the mutation's response type definition. If provided, the optimistic response will be normalized to the proxy store before <code>optimisticUpdater</code> is executed. We suggest you provide an <code>optimisticResponse</code> for two benefits:
<ul>
<li>Like <code>updater</code>, there is no need to provide <code>optimisticUpdater</code> for simple mutations (field change).</li>
<li>For more complicated mutations, <code>optimisticUpdater</code> and <code>updater</code> can be the same function.</li>
</ul></li>
<li><code>optimisticUpdater</code>: a function that takes in a proxy of the in-memory Relay store. In this function, the client defines 'how to' update the store through the proxy in an imperative way.</li>
<li><code>updater</code>: a function that updates the in-memory Relay store based on the <strong>real</strong> server response. When the server response comes back, Relay first reverts any changes introduced by <code>optimisticUpdater</code> or <code>optimisticResponse</code> and then applies the <code>updater</code> to the store.</li>
<li><code>configs</code>:  an array containing the different optimisticUpdater/updater configurations. It provides a convenient way to specify the <code>updater</code> behavior.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" name="example"></a><a href="#example" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<p>In a simple mutation, you only need <code>mutation</code> and <code>variables</code>:</p>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> {
  commitMutation,
  graphql,
} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-relay'</span>);

<span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation MarkReadNotificationMutation(
    $input: MarkReadNotificationData!
  ) {
    markReadNotification(data: $input) {
      notification {
        seenState
      }
    }
  }
`</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">markNotificationAsRead</span>(<span class="hljs-params">environment, source, storyID</span>) </span>{
  <span class="hljs-keyword">const</span> variables = {
    <span class="hljs-attr">input</span>: {
      source,
      storyID,
    },
  };

  commitMutation(
    environment,
    {
      mutation,
      variables,
      <span class="hljs-attr">onCompleted</span>: <span class="hljs-function">(<span class="hljs-params">response, errors</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Response received from server.'</span>)
      },
      <span class="hljs-attr">onError</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(err),
    },
  );
}
</code></pre>
<h1><a class="anchor" aria-hidden="true" name="updating-the-client-optimistically"></a><a href="#updating-the-client-optimistically" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating the client optimistically</h1>
<p>To improve perceived responsiveness, you may wish to perform an &quot;optimistic update&quot;, in which the client immediately updates to reflect the anticipated new value even before the response from the server has come back. We do this by providing an <code>optimisticResponse</code> and adding it to the <code>config</code> that we pass into <code>commitMutation</code>:</p>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> optimisticResponse = {
  <span class="hljs-attr">markReadNotification</span>: {
    <span class="hljs-attr">notification</span>: {
      <span class="hljs-attr">seenState</span>: SEEN,
    },
  },
};

commitMutation(
  environment,
  {
    mutation,
    optimisticResponse,
    variables,
  },
);
</code></pre>
<h1><a class="anchor" aria-hidden="true" name="configs"></a><a href="#configs" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configs</h1>
<p>We can give Relay instructions in the form of a config array on how to use the response from each mutation to update the client-side store. We do this by configuring the mutation with one or more of the following mutation types:</p>
<h2><a class="anchor" aria-hidden="true" name="node-delete"></a><a href="#node-delete" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>NODE_DELETE</h2>
<p>Given a deletedIDFieldName, Relay will remove the node(s) from the connection.</p>
<h3><a class="anchor" aria-hidden="true" name="arguments"></a><a href="#arguments" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Arguments</h3>
<ul>
<li><code>deletedIDFieldName: string</code>: The field name in the response that contains the DataID of the deleted node</li>
</ul>
<h3><a class="anchor" aria-hidden="true" name="example"></a><a href="#example" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation DestroyShipMutation($input: DestroyShipData!) {
    destroyShip(input: $input) {
      destroyedShipId
      faction {
        ships {
          id
        }
      }
    }
  }
`</span>;

<span class="hljs-keyword">const</span> configs = [{
  <span class="hljs-attr">type</span>: <span class="hljs-string">'NODE_DELETE'</span>,
  <span class="hljs-attr">deletedIDFieldName</span>: <span class="hljs-string">'destroyedShipId'</span>,
}];
</code></pre>
<h2><a class="anchor" aria-hidden="true" name="range-add"></a><a href="#range-add" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANGE_ADD</h2>
<p>Given a parent, information about the connection, and the name of the newly created edge in the response payload Relay will add the node to the store and attach it to the connection according to the range behavior(s) specified in the connectionInfo.</p>
<h3><a class="anchor" aria-hidden="true" name="arguments"></a><a href="#arguments" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Arguments</h3>
<ul>
<li><code>parentID: string</code>: The DataID of the parent node that contains the
connection.</li>
<li><code>connectionInfo: Array&lt;{key: string, filters?: Variables, rangeBehavior: string}&gt;</code>: An array of objects containing a connection key, an object
containing optional filters, and a range behavior depending on what behavior we expect (append, prepend, or ignore).
<ul>
<li><code>filters</code>: An object containing GraphQL calls e.g. <code>const filters = {'orderby': 'chronological'};</code>.</li>
</ul></li>
<li><code>edgeName: string</code>: The field name in the response that represents the newly created edge</li>
</ul>
<h3><a class="anchor" aria-hidden="true" name="example"></a><a href="#example" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation AddShipMutation($input: AddShipData!) {
    addShip(input: $input) {
      faction {
        ships {
          id
        }
      }
      newShipEdge
    }
  }
`</span>;

<span class="hljs-keyword">const</span> configs = [{
  <span class="hljs-attr">type</span>: <span class="hljs-string">'RANGE_ADD'</span>,
  <span class="hljs-attr">parentID</span>: <span class="hljs-string">'shipId'</span>,
  <span class="hljs-attr">connectionInfo</span>: [{
    <span class="hljs-attr">key</span>: <span class="hljs-string">'AddShip_ships'</span>,
    <span class="hljs-attr">rangeBehavior</span>: <span class="hljs-string">'append'</span>,
  }],
  <span class="hljs-attr">edgeName</span>: <span class="hljs-string">'newShipEdge'</span>,
}];
</code></pre>
<h2><a class="anchor" aria-hidden="true" name="range-delete"></a><a href="#range-delete" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANGE_DELETE</h2>
<p>Given a parent, connectionKeys, one or more DataIDs in the response payload, and
a path between the parent and the connection, Relay will remove the node(s)
from the connection but leave the associated record(s) in the store.</p>
<h3><a class="anchor" aria-hidden="true" name="arguments"></a><a href="#arguments" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Arguments</h3>
<ul>
<li><code>parentID: string</code>: The DataID of the parent node that contains the
connection.</li>
<li><code>connectionKeys: Array&lt;{key: string, filters?: Variables}&gt;</code>: An array of
objects containing a connection key and optionally filters.
<ul>
<li><code>filters</code>: An object containing GraphQL calls e.g. <code>const filters = {'orderby': 'chronological'};</code>.</li>
</ul></li>
<li><code>pathToConnection: Array&lt;string&gt;</code>: An array containing the field names between the parent and the connection, including the parent and the connection.</li>
<li><code>deletedIDFieldName: string | Array&lt;string&gt;</code>: The field name in the response that contains the DataID of the removed node, or the path to the node removed from the connection</li>
</ul>
<h3><a class="anchor" aria-hidden="true" name="example"></a><a href="#example" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h3>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation RemoveTagsMutation($input: RemoveTagsData!) {
    removeTags(input: $input) {
      todo {
        tags {
          id
        }
      }
      removedTagId
    }
  }
`</span>;

<span class="hljs-keyword">const</span> configs = [{
  <span class="hljs-attr">type</span>: <span class="hljs-string">'RANGE_DELETE'</span>,
  <span class="hljs-attr">parentID</span>: <span class="hljs-string">'todoId'</span>,
  <span class="hljs-attr">connectionKeys</span>: [{
    <span class="hljs-attr">key</span>: RemoveTags_tags,
  }],
  <span class="hljs-attr">pathToConnection</span>: [<span class="hljs-string">'todo'</span>, <span class="hljs-string">'tags'</span>],
  <span class="hljs-attr">deletedIDFieldName</span>: removedTagId
}];
</code></pre>
<p>For examples of more complex optimistic updates, including adding and removing from a list, see the <a href="https://github.com/relayjs/relay-examples/tree/master/todo">Relay Modern Todo example app</a>.</p>
<h1><a class="anchor" aria-hidden="true" name="updating-the-store-programatically-advanced"></a><a href="#updating-the-store-programatically-advanced" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating the store programatically (advanced)</h1>
<p>The Relay store can be mutated programatically in advanced edge cases when optimistic updates need more granular control. The following API methods are useful for mutating your connections and fragments.</p>
<h2><a class="anchor" aria-hidden="true" name="relayrecordstore"></a><a href="#relayrecordstore" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RelayRecordStore</h2>
<h3><a class="anchor" aria-hidden="true" name="getsource-recordsource-https-githubcom-facebook-relay-blob-d0310d69012bba615dacf614319bcf47ee2a0f3f-packages-relay-runtime-architecturemd"></a><a href="#getsource-recordsource-https-githubcom-facebook-relay-blob-d0310d69012bba615dacf614319bcf47ee2a0f3f-packages-relay-runtime-architecturemd" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getSource(): <a href="https://github.com/facebook/relay/blob/d0310d69012bba615dacf614319bcf47ee2a0f3f/packages/relay-runtime/ARCHITECTURE.md">RecordSource</a></h3>
<p>Returns a read-only view of the store's internal RecordSource that holds all records.</p>
<h3><a class="anchor" aria-hidden="true" name="getrootfieldfieldname-string-recordproxy"></a><a href="#getrootfieldfieldname-string-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getRootField(fieldName: string): ?RecordProxy</h3>
<p>Returns a proxy class for manipulating records from a record source, for example a query, mutation, or the store.</p>
<h2><a class="anchor" aria-hidden="true" name="relayrecordproxy"></a><a href="#relayrecordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RelayRecordProxy</h2>
<h3><a class="anchor" aria-hidden="true" name="getdataid-dataid-https-githubcom-facebook-relay-blob-d0310d69012bba615dacf614319bcf47ee2a0f3f-packages-relay-runtime-architecturemd"></a><a href="#getdataid-dataid-https-githubcom-facebook-relay-blob-d0310d69012bba615dacf614319bcf47ee2a0f3f-packages-relay-runtime-architecturemd" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getDataID(): <a href="https://github.com/facebook/relay/blob/d0310d69012bba615dacf614319bcf47ee2a0f3f/packages/relay-runtime/ARCHITECTURE.md">DataID</a></h3>
<p>Returns the globally unique identifier string for a record.</p>
<h3><a class="anchor" aria-hidden="true" name="gettype-relayqltype"></a><a href="#gettype-relayqltype" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getType(): RelayQLType</h3>
<p>Returns the GraphQL type name for a given record.</p>
<h3><a class="anchor" aria-hidden="true" name="getvaluename-string-args-variables-mixed"></a><a href="#getvaluename-string-args-variables-mixed" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getValue(name: string, args?: ?Variables): mixed</h3>
<p>Reads the value of an attribute on a record by the field name and an object representing pre-defined argument values.</p>
<h3><a class="anchor" aria-hidden="true" name="setvaluevalue-mixed-name-string-args-variables-recordproxy"></a><a href="#setvaluevalue-mixed-name-string-args-variables-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>setValue(value: mixed, name: string, args?: ?Variables): RecordProxy</h3>
<p>Updates the value of a mutable record's attribute given by the field name and an object representing pre-defined argument values.</p>
<h3><a class="anchor" aria-hidden="true" name="getlinkedrecordname-string-args-variables-recordproxy"></a><a href="#getlinkedrecordname-string-args-variables-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getLinkedRecord(name: string, args?: ?Variables): ?RecordProxy</h3>
<h3><a class="anchor" aria-hidden="true" name="getlinkedrecordsname-string-args-variables-array-recordproxy"></a><a href="#getlinkedrecordsname-string-args-variables-array-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getLinkedRecords(name: string, args?: ?Variables): ?Array&lt;?RecordProxy&gt;</h3>
<p>Retrieves record(s) associated with the given record, transversing the source by field name and an object representing pre-defined argument values.</p>
<h3><a class="anchor" aria-hidden="true" name="setlinkedrecordrecord-recordproxy-name-string-args-variables-recordproxy"></a><a href="#setlinkedrecordrecord-recordproxy-name-string-args-variables-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>setLinkedRecord(record: RecordProxy, name: string, args?: ?Variables): RecordProxy</h3>
<h3><a class="anchor" aria-hidden="true" name="setlinkedrecordsrecords-array-recordproxy-name-string-args-variables-recordproxy"></a><a href="#setlinkedrecordsrecords-array-recordproxy-name-string-args-variables-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>setLinkedRecords(records: Array&lt;?RecordProxy&gt;, name: string, args?: ?Variables ): RecordProxy</h3>
<p>Updates the records associated with a mutable record, transversing the source by field name and an object representing pre-defined argument values.</p>
<h3><a class="anchor" aria-hidden="true" name="getorcreatelinkedrecordname-string-typename-string-args-variables-recordproxy"></a><a href="#getorcreatelinkedrecordname-string-typename-string-args-variables-recordproxy" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>getOrCreateLinkedRecord(name: string, typeName: string, args?: ?Variables ): RecordProxy</h3>
<p>Finds or creates a single record associated with a mutable record.
This is a shortcut to <code>RelayRecordProxy.getLinkedRecord</code> with <code>RelayRecordProxy.setLinkedRecord</code> should the associated record be non-existant.</p>
<h2><a class="anchor" aria-hidden="true" name="advanced-mutation-example"></a><a href="#advanced-mutation-example" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Advanced Mutation Example</h2>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> sharedUpdater = <span class="hljs-function">(<span class="hljs-params">source, todoItem</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sourceRecord = source.getRootField(<span class="hljs-string">'todoList'</span>);

    <span class="hljs-keyword">const</span> todoItems = sourceRecord.getLinkedRecords(<span class="hljs-string">'todoItems'</span>);
    <span class="hljs-keyword">if</span> (todoItems) {
      sourceRecord.setLinkedRecords(todoItems.concat(todoItem), <span class="hljs-string">'todoItems'</span>);
    }
};

<span class="hljs-keyword">const</span> variables = {
  <span class="hljs-attr">todoItem</span>: {
    <span class="hljs-attr">task</span>: <span class="hljs-string">'Finish this example!'</span>,
    <span class="hljs-attr">dueDate</span>: <span class="hljs-literal">null</span>,
  }
}

commitMutation(store, {
  mutation,
  variables,
  <span class="hljs-attr">updater</span>: <span class="hljs-function">(<span class="hljs-params">store</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> mutationRoot = store.getRootField(<span class="hljs-string">'addTodoItem'</span>);
    <span class="hljs-keyword">const</span> todoItem = mutationRoot.getLinkedRecord(<span class="hljs-string">'todoItem'</span>);
    sharedUpdater(store, todoItem);
  },
  <span class="hljs-attr">optimisticUpdater</span>: <span class="hljs-function">(<span class="hljs-params">store</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> todoItem = mutationRoot.getLinkedRecord(<span class="hljs-string">'todoItem'</span>);
    sharedUpdater(store, variables.todoItem);
  }
});
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="routing.html">← Routing</a><a class="docs-next button" href="subscriptions.html">Subscriptions →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/relay/" class="nav-home"><img src="/relay/img/relay.svg" alt="Relay" width="66" height="58"/></a><div><h5>Docs</h5><a href="/relay/docs/en/getting-started.html">Getting Started</a></div><div><h5>Community</h5><a href="/relay/en/users.html">User Showcase</a></div><div><h5>More</h5><a href="https://github.com/facebook/relay">GitHub</a><a class="github-button" href="https://github.com/facebook/relay" data-icon="octicon-star" data-count-href="/facebook/relay/stargazers" data-count-api="/repos/facebook/relay#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/relay/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '3d7d5825d50ea36bca0e6ad06c926f06',
                indexName: 'relay',
                inputSelector: '#search_input_react'
              });
            </script></body></html>