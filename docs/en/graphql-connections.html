<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Connection · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Connection · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/relay/index.html"/><meta property="og:description" content="A faction has many ships in the Star Wars universe. Relay contains functionality to make manipulating one-to-many relationships easy, using a standardized way of expressing these one-to-many relationships. This standard connection model offers ways of slicing and paginating through the connection."/><link rel="shortcut icon" href="/relay/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/relay/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/relay/"><img class="logo" src="/relay/img/relay-white.svg"/><h2 class="headerTitle">Relay</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/relay/docs/en/getting-started.html" target="_self">Docs</a></li><li><a href="/relay/en/help.html" target="_self">Support</a></li><li><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>GraphQL</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Quick Start</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/tutorial.html">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/thinking-in-graphql.html">Thinking in GraphQL</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/thinking-in-relay.html">Thinking In Relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/videos.html">Videos</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Modern</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-modern.html">Introduction to Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/new-in-relay-modern.html">New in Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-environment.html">The Relay &quot;Environment&quot;</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/network-layer.html">The Relay Network Layer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/query-renderer.html">QueryRenderer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/fragment-container.html">FragmentContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/refetch-container.html">RefetchContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/pagination-container.html">PaginationContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/routing.html">Routing</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/subscriptions.html">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-directives.html">Directives</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/babel-plugin-relay.html">babel-plugin-relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-compiler.html">Relay Compiler</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-debugging.html">Debugging</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Compat</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/relay-compat.html">Compatibility Mode</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/conversion-playbook.html">Conversion Playbook</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/conversion-scripts.html">Conversion Scripts</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/upgrading-setvariables.html">Upgrading setVariables</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/compatibility-cheatsheet.html">Compatibility Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-cheatsheet.html">API Cheatsheet</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic Guides</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-containers.html">Containers</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-routes.html">Routes</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-root-container.html">Root Container</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-ready-state.html">Ready State</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-network-layer.html">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/guides-babel-plugin.html">Babel Relay Plugin</a></li></ul></div><div class="navGroup navGroupActive"><h3>GraphQL</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-relay-specification.html">GraphQL Relay Specification</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-object-identification.html">Object Identification</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/relay/docs/en/graphql-connections.html">Connection</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-mutations.html">Mutations</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/graphql-further-reading.html">Further Reading</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic API</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay.html">Relay</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-container.html">RelayContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-route.html">Relay.Route</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-renderer.html">Relay.Renderer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-root-container.html">Relay.RootContainer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-ql.html">Relay.QL</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-mutation.html">Relay.Mutation</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-graphql-mutation.html">Relay.GraphQLMutation</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-proptypes.html">Relay.PropTypes</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/api-reference-relay-store.html">Relay.Store</a></li></ul></div><div class="navGroup navGroupActive"><h3>Relay Classic Interfaces</h3><ul><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-mutation-request.html">RelayMutationRequest</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-network-layer.html">RelayNetworkLayer</a></li><li class="navListItem"><a class="navItem" href="/relay/docs/en/interfaces-relay-query-request.html">RelayQueryRequest</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/relay/edit/master/docs/GraphQL-Connections.md" target="_blank">Edit</a><h1>Connection</h1></header><article><div><span><p>A faction has many ships in the Star Wars universe. Relay contains functionality to make manipulating one-to-many relationships easy, using a standardized way of expressing these one-to-many relationships. This standard connection model offers ways of slicing and paginating through the connection.</p>
<p>Let's take the rebels, and ask for their first ship:</p>
<pre><code class="hljs">query RebelsShipsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">1</span>) {
      edges {
        node {
          name
        }
      }
    }
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css json">{
  <span class="hljs-attr">"rebels"</span>: {
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alliance to Restore the Republic"</span>,
    <span class="hljs-attr">"ships"</span>: {
      <span class="hljs-attr">"edges"</span>: [
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"X-Wing"</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>That used the <code>first</code> argument to <code>ships</code> to slice the result set down to the first one. But what if we wanted to paginate through it? On each edge, a cursor will be exposed that we can use to paginate. Let's ask for the first two this time, and get the cursor as well:</p>
<pre><code class="hljs">query MoreRebelShipsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">2</span>) {
      edges {
        cursor
        node {
          name
        }
      }
    }
  }
}
</code></pre>
<p>and we get back</p>
<pre><code class="hljs css json">{
  <span class="hljs-attr">"rebels"</span>: {
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alliance to Restore the Republic"</span>,
    <span class="hljs-attr">"ships"</span>: {
      <span class="hljs-attr">"edges"</span>: [
        {
          <span class="hljs-attr">"cursor"</span>: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjA="</span>,
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"X-Wing"</span>
          }
        },
        {
          <span class="hljs-attr">"cursor"</span>: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjE="</span>,
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Y-Wing"</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>Notice that the cursor is a base64 string. That's the pattern from earlier: the server is reminding us that this is an opaque string. We can pass this string back to the server as the <code>after</code> argument to the <code>ships</code> field, which will let us ask for the next three ships after the last one in the previous result:</p>
<pre><code class="hljs">query EndOfRebelShipsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">3</span> after: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjE="</span>) {
      edges {
        cursor,
        node {
          name
        }
      }
    }
  }
}
</code></pre>
<p>gives us</p>
<pre><code class="hljs css json">
{
  <span class="hljs-attr">"rebels"</span>: {
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alliance to Restore the Republic"</span>,
    <span class="hljs-attr">"ships"</span>: {
      <span class="hljs-attr">"edges"</span>: [
        {
          <span class="hljs-attr">"cursor"</span>: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjI="</span>,
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"A-Wing"</span>
          }
        },
        {
          <span class="hljs-attr">"cursor"</span>: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjM="</span>,
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Millenium Falcon"</span>
          }
        },
        {
          <span class="hljs-attr">"cursor"</span>: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjQ="</span>,
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Home One"</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>Sweet! Let's keep going and get the next four!</p>
<pre><code class="hljs">query RebelsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">4</span> after: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjQ="</span>) {
      edges {
        cursor,
        node {
          name
        }
      }
    }
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css json">{
  <span class="hljs-attr">"rebels"</span>: {
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alliance to Restore the Republic"</span>,
    <span class="hljs-attr">"ships"</span>: {
      <span class="hljs-attr">"edges"</span>: []
    }
  }
}
</code></pre>
<p>Hm. There were no more ships; guess there were only five in the system for the rebels. It would have been nice to know that we'd reached the end of the connection, without having to do another round trip in order to verify that. The connection model exposes this capability with a type called <code>PageInfo</code>. So let's issue the two queries that got us ships again, but this time ask for <code>hasNextPage</code>:</p>
<pre><code class="hljs">query <span class="hljs-class">EndOfRebelShipsQuery </span>{
  <span class="hljs-class">rebels </span>{
    name,
<span class="hljs-symbol">    originalShips:</span> ships(first: <span class="hljs-number">2</span>) {
      <span class="hljs-class">edges </span>{
        <span class="hljs-class">node </span>{
          name
        }
      }
      <span class="hljs-class">pageInfo </span>{
        hasNextPage
      }
    }
<span class="hljs-symbol">    moreShips:</span> ships(first: <span class="hljs-number">3</span> after: <span class="hljs-string">"YXJyYXljb25uZWN0aW9uOjE="</span>) {
      <span class="hljs-class">edges </span>{
        <span class="hljs-class">node </span>{
          name
        }
      }
      <span class="hljs-class">pageInfo </span>{
        hasNextPage
      }
    }
  }
}
</code></pre>
<p>and we get back</p>
<pre><code class="hljs css json">{
  <span class="hljs-attr">"rebels"</span>: {
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alliance to Restore the Republic"</span>,
    <span class="hljs-attr">"originalShips"</span>: {
      <span class="hljs-attr">"edges"</span>: [
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"X-Wing"</span>
          }
        },
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Y-Wing"</span>
          }
        }
      ],
      <span class="hljs-attr">"pageInfo"</span>: {
        <span class="hljs-attr">"hasNextPage"</span>: <span class="hljs-literal">true</span>
      }
    },
    <span class="hljs-attr">"moreShips"</span>: {
      <span class="hljs-attr">"edges"</span>: [
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"A-Wing"</span>
          }
        },
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Millenium Falcon"</span>
          }
        },
        {
          <span class="hljs-attr">"node"</span>: {
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Home One"</span>
          }
        }
      ],
      <span class="hljs-attr">"pageInfo"</span>: {
        <span class="hljs-attr">"hasNextPage"</span>: <span class="hljs-literal">false</span>
      }
    }
  }
}
</code></pre>
<p>So on the first query for ships, GraphQL told us there was a next page, but on the next one, it told us we'd reached the end of the connection.</p>
<p>Relay uses all of this functionality to build out abstractions around connections, to make these easy to work with efficiently without having to manually manage cursors on the client.</p>
<p>Complete details on how the server should behave are available in the <a href="/relay/graphql/connections.htm">GraphQL Cursor Connections</a> spec.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="graphql-object-identification.html">← Object Identification</a><a class="docs-next button" href="graphql-mutations.html">Mutations →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/relay/" class="nav-home"><img src="/relay/img/relay.svg" alt="Relay" width="66" height="58"/></a><div><h5>Docs</h5><a href="/relay/docs/en/getting-started.html">Getting Started</a></div><div><h5>Community</h5><a href="/relay/en/users.html">User Showcase</a></div><div><h5>More</h5><a href="https://github.com/facebook/relay">GitHub</a><a class="github-button" href="https://github.com/facebook/relay" data-icon="octicon-star" data-count-href="/facebook/relay/stargazers" data-count-api="/repos/facebook/relay#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/relay/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '3d7d5825d50ea36bca0e6ad06c926f06',
                indexName: 'relay',
                inputSelector: '#search_input_react'
              });
            </script></body></html>